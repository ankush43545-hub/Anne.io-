<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anne Chat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <style>
        body { background-color: #0a0a0c; color: #e2e8f0; font-family: sans-serif; overflow: hidden; }
        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .purple-glow { background: radial-gradient(circle at center, rgba(124, 58, 237, 0.15) 0%, transparent 70%); }
    </style>
</head>
<body x-data="chatApp()">

    <div class="flex h-screen w-full relative">
        <div class="absolute top-[-10%] left-[-10%] w-[50%] h-[50%] purple-glow blur-[100px] pointer-events-none"></div>
        <div class="absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-indigo-900/10 blur-[100px] pointer-events-none"></div>

        <aside class="hidden md:flex w-20 flex-col items-center py-8 border-r border-white/5 bg-[#0d0d10] z-20">
            <div class="w-12 h-12 rounded-2xl bg-gradient-to-tr from-purple-600 to-indigo-500 flex items-center justify-center mb-10 shadow-lg shadow-purple-500/20">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 8V4H8"/><rect width="16" height="12" x="4" y="8" rx="2"/><path d="M2 14h2"/><path d="M20 14h2"/><path d="M15 13v2"/><path d="M9 13v2"/></svg>
            </div>
        </aside>

        <main class="flex-1 flex flex-col z-10">
            <header class="h-20 flex items-center justify-between px-8 border-b border-white/5 glass">
                <div class="flex items-center gap-4">
                    <div class="relative">
                        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Anne" class="w-10 h-10 rounded-full bg-slate-800 border border-white/10" alt="Anne">
                        <span class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 border-2 border-[#0a0a0c] rounded-full"></span>
                    </div>
                    <div>
                        <h2 class="font-semibold text-lg">Anne</h2>
                        <p class="text-[10px] text-slate-500 uppercase tracking-widest font-bold">Always Active</p>
                    </div>
                </div>
            </header>

            <div class="flex-1 overflow-y-auto p-6 space-y-6 scrollbar-hide" id="chat-feed">
                <template x-for="msg in messages" :key="msg.id">
                    <div :class="msg.sender === 'user' ? 'justify-end' : 'justify-start'" class="flex w-full">
                        <div 
                            x-show="true"
                            x-transition:enter="transition ease-out duration-300"
                            x-transition:enter-start="opacity-0 transform translate-y-4 scale-95"
                            x-transition:enter-end="opacity-100 transform translate-y-0 scale-100"
                            :class="msg.sender === 'user' ? 'bg-purple-600 text-white rounded-tr-none' : 'glass text-slate-200 rounded-tl-none'"
                            class="max-w-[80%] px-5 py-3 rounded-2xl shadow-xl"
                            x-text="msg.text"
                        ></div>
                    </div>
                </template>

                <div x-show="isTyping" class="flex justify-start">
                    <div class="glass px-5 py-4 rounded-2xl rounded-tl-none">
                        <div class="flex gap-1">
                            <div class="w-1.5 h-1.5 bg-purple-500 rounded-full animate-bounce"></div>
                            <div class="w-1.5 h-1.5 bg-purple-500 rounded-full animate-bounce [animation-delay:0.2s]"></div>
                            <div class="w-1.5 h-1.5 bg-purple-500 rounded-full animate-bounce [animation-delay:0.4s]"></div>
                        </div>
                    </div>
                </div>
            </div>

            <footer class="p-6">
                <form @submit.prevent="sendMessage()" class="max-w-4xl mx-auto flex items-center gap-3 glass p-2 rounded-2xl">
                    <input 
                        type="text" 
                        x-model="userInput" 
                        placeholder="Talk to Anne..." 
                        class="flex-1 bg-transparent px-4 py-3 outline-none text-slate-200 placeholder:text-slate-600"
                    >
                    <button type="submit" class="bg-purple-600 hover:bg-purple-500 p-3 rounded-xl transition-all active:scale-90">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
                    </button>
                </form>
            </footer>
        </main>
    </div>

    <script>
        function chatApp() {
            return {
                messages: [{ id: 1, text: "Hey! It's Anne. I'm so glad to see you again.", sender: 'bot' }],
                userInput: '',
                isTyping: false,
                async sendMessage() {
                    if (!this.userInput.trim()) return;
                    
                    const text = this.userInput;
                    this.messages.push({ id: Date.now(), text: text, sender: 'user' });
                    this.userInput = '';
                    this.isTyping = true;
                    this.scrollToBottom();

                    try {
                        const response = await fetch('https://anne-io.onrender.com/chat', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ message: text })
                        });
                        const data = await response.json();
                        this.messages.push({ id: Date.now() + 1, text: data.reply, sender: 'bot' });
                    } catch (e) {
                        this.messages.push({ id: Date.now() + 1, text: "I'm having a bit of trouble connecting to my brain right now...", sender: 'bot' });
                    } finally {
                        this.isTyping = false;
                        this.scrollToBottom();
                    }
                },
                scrollToBottom() {
                    setTimeout(() => {
                        const el = document.getElementById('chat-feed');
                        el.scrollTop = el.scrollHeight;
                    }, 50);
                }
            }
        }
    </script>
</body>
</html>
